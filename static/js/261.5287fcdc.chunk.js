"use strict";(self.webpackChunktoolbox=self.webpackChunktoolbox||[]).push([[261],{261:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});var r=n(9439),a=n(2791),s=n(6445),o=n(4554),i=n(890),l=n(4518),c=n(4045),u=n(6934),f=n(4802),h=n.n(f),d=n(2403),x=n.n(d),v=(n(1927),n(184)),g=(0,u.ZP)("input")({display:"none"}),p={modes:["code","view"],language:"zh-CN",mode:"code",search:!0};function j(){var e=(0,a.useRef)(),t=(0,a.useState)(),n=(0,r.Z)(t,2),u=n[0],f=n[1],d=(0,a.useState)({}),j=(0,r.Z)(d,2),m=j[0],Z=j[1];(0,a.useEffect)((function(){e.current&&f(new(x())(e.current,p))}),[]),(0,a.useEffect)((function(){u&&m&&u.set(m)}),[u,m]);return(0,v.jsxs)(s.Z,{children:[(0,v.jsx)(o.Z,{sx:{mt:2},children:(0,v.jsx)(i.Z,{variant:"h2",children:"Excel \u8f6c JSON"})}),(0,v.jsxs)(o.Z,{sx:{mt:2},children:[(0,v.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,v.jsx)(g,{accept:".xls,.xlsx,.csv",id:"contained-button-file",multiple:!0,type:"file",onChange:function(e){console.log(e.target.files),console.log(e.target.value);var t=e.target.files;if(t)for(var n=0;n<t.length;n++){var r=new FileReader;r.onload=function(e){if(e.target){var t=e.target.result;t=new Uint8Array(t);var n=c.ij(t,{type:"array"});console.log(n);var r=n.Sheets[n.SheetNames[0]],a=c.P6.sheet_to_json(r)||[];Z(a)}};var a=t.item(n);a&&r.readAsArrayBuffer(a)}}}),(0,v.jsx)(l.Z,{variant:"contained",component:"span",children:"\u4e0a\u4f20 Excel"})]}),(0,v.jsx)(l.Z,{onClick:function(){if(u){var e=u.getText();if("{}"!==e&&""!==e){var t=Date.now(),n=new File([e],t+".json",{type:"text/plain;charset=utf-8"});h().saveAs(n)}}},children:"\u4e0b\u8f7d\u4e3a JSON \u6587\u4ef6"})]}),(0,v.jsx)(o.Z,{sx:{mt:2,height:"90vh"},ref:e})]})}}}]);
//# sourceMappingURL=261.5287fcdc.chunk.js.map