(self["webpackChunk"]=self["webpackChunk"]||[]).push([[997],{48490:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var r=n(57337),a=n(67294),s=n(54065),l=n(71508),i=n(2658),c=n(72642),o=n(54701),u=n(90948),f=n(93162),h=n.n(f),d=n(13807),v=n.n(d),x=n(85893),g=(0,u.ZP)("input")({display:"none"}),p={modes:["code","view"],language:"zh-CN",mode:"code",search:!0};function j(){var e=(0,a.useRef)(),t=(0,a.useState)(),n=(0,r.Z)(t,2),u=n[0],f=n[1],d=(0,a.useState)({}),j=(0,r.Z)(d,2),m=j[0],Z=j[1];(0,a.useEffect)((()=>{e.current&&f(new(v())(e.current,p))}),[]),(0,a.useEffect)((()=>{u&&m&&u.set(m)}),[u,m]);var w=()=>{if(u){var e=u.getText();if("{}"!==e&&""!==e){var t=Date.now(),n=new File([e],t+".json",{type:"text/plain;charset=utf-8"});h().saveAs(n)}}},y=e=>{console.log(e.target.files),console.log(e.target.value);var t=e.target.files;if(t)for(var n=0;n<t.length;n++){var r=new FileReader;r.onload=e=>{if(e.target){var t=e.target.result;t=new Uint8Array(t);var n=o.ij(t,{type:"array"});console.log(n);var r=n.Sheets[n.SheetNames[0]],a=o.P6.sheet_to_json(r)||[];Z(a)}};var a=t.item(n);a&&r.readAsArrayBuffer(a)}};return(0,x.jsxs)(s.Z,{children:[(0,x.jsx)(l.Z,{sx:{mt:2},children:(0,x.jsx)(i.Z,{variant:"h2",children:"Excel \u8f6c JSON"})}),(0,x.jsxs)(l.Z,{sx:{mt:2},children:[(0,x.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,x.jsx)(g,{accept:".xls,.xlsx,.csv",id:"contained-button-file",multiple:!0,type:"file",onChange:y}),(0,x.jsx)(c.Z,{variant:"contained",component:"span",children:"\u4e0a\u4f20 Excel"})]}),(0,x.jsx)(c.Z,{onClick:w,children:"\u4e0b\u8f7d\u4e3a JSON \u6587\u4ef6"})]}),(0,x.jsx)(l.Z,{sx:{mt:2,height:"90vh"},ref:e})]})}},20067:function(){}}]);